# ç”¨æˆ·ä¸­å¿ƒ

é¡¹ç›®æ€è·¯ï¼Œä¼ä¸šçº§å¼€å‘æŠ€æœ¯

## ä¼ä¸šé¡¹ç›®æµç¨‹

éœ€æ±‚åˆ†æ => è®¾è®¡ï¼ˆæ¦‚è¦ï¼Œè¯¦ç»†ï¼‰=> æŠ€æœ¯é€‰å‹ï¼ˆåŸå› å’Œç†ç”±ï¼‰=> åˆå§‹åŒ–/å¼•å…¥éœ€è¦æŠ€æœ¯=> å†™Demo => ä»£ç å®ç°ä¸šåŠ¡é€»è¾‘ï¼ˆå…ˆåšè®¾è®¡=>ä»£ç å®ç°=>æŒç»­ä¼˜åŒ–ï¼‰ => æµ‹è¯•ï¼ˆå•å…ƒæµ‹è¯•ï¼‰**æœ€å·¦åŸåˆ™ï¼Ÿï¼ˆæŸ¥è¯¢ï¼‰** => ä»£ç æäº¤/ä»£ç è¯„å®¡ => éƒ¨ç½² => å‘å¸ƒ

- éƒ¨ç½²æ³¨æ„ç‚¹ï¼š

  - è·¨åŸŸé—®é¢˜ï¼šéœ€é…ç½®nginxåå‘ä»£ç†

  ```
  # é€šç”¨Nginxè·¨åŸŸé…ç½®æ¨¡æ¿
  server {
      listen 80;
      server_name yourdomain.com;  # æ›¿æ¢ä¸ºæ‚¨çš„åŸŸåæˆ–IP
      root /var/www/your-project;  # æ›¿æ¢ä¸ºæ‚¨çš„é¡¹ç›®è·¯å¾„
      
      # åŸºç¡€è·¨åŸŸè®¾ç½®
      add_header 'Access-Control-Allow-Origin' '$http_origin' always;
      add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
      add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization' always;
      add_header 'Access-Control-Expose-Headers' 'Content-Length,Content-Range' always;
      add_header 'Access-Control-Max-Age' 1728000 always;
      
      # å…è®¸æºå¸¦å‡­è¯ï¼ˆå¦‚éœ€cookieè®¤è¯è¯·å–æ¶ˆæ³¨é‡Šï¼ŒåŒæ—¶ä¸èƒ½ä½¿ç”¨*ä½œä¸ºoriginï¼‰
      # add_header 'Access-Control-Allow-Credentials' 'true' always;
      
      # å¤„ç†OPTIONSé¢„æ£€è¯·æ±‚
      if ($request_method = 'OPTIONS') {
          add_header 'Content-Type' 'text/plain; charset=utf-8';
          add_header 'Content-Length' 0;
          return 204;
      }
  
      # é™æ€æ–‡ä»¶ç¼“å­˜è®¾ç½®
      location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
          expires 1y;
          add_header Cache-Control "public, no-transform";
          access_log off;
          try_files $uri =404;
      }
  
      # å‰ç«¯è·¯ç”±å¤„ç†ï¼ˆé€‚ç”¨äºå•é¡µåº”ç”¨ï¼‰
      location / {
          try_files $uri $uri/ /index.html;
      }
  
      # APIä»£ç†è®¾ç½®ï¼ˆç¤ºä¾‹ï¼‰
      location /api/ {
          proxy_pass http://backend-server:8080;  # æ›¿æ¢ä¸ºæ‚¨çš„åç«¯åœ°å€
          proxy_http_version 1.1;
          proxy_set_header Upgrade $http_upgrade;
          proxy_set_header Connection 'upgrade';
          proxy_set_header Host $host;
          proxy_set_header X-Real-IP $remote_addr;
          proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
          proxy_cache_bypass $http_upgrade;
          
          # ä¿æŒè·¨åŸŸè®¾ç½®ä¸ä¸»é…ç½®ä¸€è‡´
          add_header 'Access-Control-Allow-Origin' '$http_origin' always;
          add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
          add_header 'Access-Control-Allow-Headers' 'DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization' always;
      }
  
      # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
      location ~ /\. {
          deny all;
          access_log off;
          log_not_found off;
      }
  
      # é”™è¯¯é¡µé¢é…ç½®
      error_page 404 /404.html;
      error_page 500 502 503 504 /50x.html;
      
      # Gzipå‹ç¼©é…ç½®ï¼ˆå¯é€‰ï¼‰
      gzip on;
      gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
      gzip_min_length 1024;
      gzip_comp_level 6;
      gzip_vary on;
  }
  
  ```

  - å®‰å…¨é—®é¢˜ï¼šæ”¾è¡Œç«¯å£ï¼ˆ3306ï¼Œ80ï¼Œ6379ï¼‰
  - è§„èŒƒé—®é¢˜ï¼šymlä¸è¦å†™æˆyaml
  - æ•°æ®åº“æƒé™é—®é¢˜

## éœ€æ±‚åˆ†æ

1. ç™»å½•/æ³¨å†Œ

   1. æ³¨å†Œåˆ†æ
      1. ç”¨æˆ·éœ€è¦è¾“å…¥**è´¦å·**ã€**å¯†ç **ã€**æ ¡éªŒç **
      2. ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯è¿›è¡Œæ ¡éªŒ
         1. è´¦å·ä¸å°äº4ä½
         2. å¯†ç ä¸å°äº8ä½
         3. è´¦å·ä¸èƒ½é‡å¤ï¼ˆæ”¾æœ€åï¼Œé˜²æ­¢èµ„æºæµªè´¹ï¼‰
         4. è´¦å·ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
         5. å¯†ç å’Œæ ¡éªŒç ä¸€æ ·
      3. å¯¹å¯†ç è¿›è¡ŒåŠ å¯†
      4. å‘æ•°æ®åº“ä¸­æ’å…¥ä¿¡æ¯
   2. ç™»å½•åˆ†æ
      1. æ ¡éªŒæ˜¯å¦åˆæ³•
         1. ç”¨æˆ·è¾“å…¥è´¦å·ã€å¯†ç 
         2. è´¦å·ä¸å°äº4ä½
         3. å¯†ç ä¸å°äº8ä½
         4. è´¦å·ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
      2. æ ¡éªŒå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œéœ€è¦å’Œæ•°æ®åº“ä¸­çš„å¯†æ–‡å¯†ç å¯¹æ¯”
      3. ç”¨æˆ·è¿›è¡Œè„±æ•ï¼Œéšè—æ•æ„Ÿä¿¡æ¯ï¼Œé˜²æ­¢æ•°æ®åº“ä¸­çš„å­—æ®µæ³„éœ²
      4. ä¿å­˜ç”¨æˆ·çš„çŠ¶æ€
      5. å¯¹ç”¨æˆ·çš„ä¿¡æ¯è¿›è¡Œè¿”å›

2. ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥è¯¢ã€æ›´æ”¹ï¼‰

   1. æŸ¥è¯¢ç”¨æˆ·
      1. æ ¹æ®ç”¨æˆ·åè¿›è¡ŒæŸ¥è¯¢
      2. éœ€è¦åŠ é‰´æƒ
   2. åˆ é™¤ç”¨æˆ·
      1. éœ€è¦åŠ é‰´æƒ

3. ç”¨æˆ·æ ¡éªŒ (ç³»ç»Ÿç”¨æˆ·å¯è§)

   ä»…é€‚ç”¨äºç”¨æˆ·å¯ä¿¡çš„æƒ…å†µ

   å…ˆè®©ç”¨æˆ·è‡ªå·±å¡«å†™ï¼š2-5ä½æ˜Ÿçƒç¼–å·

   - åå°è¡¥å……å¯¹ç¼–å·çš„æ ¡éªŒ
     - é•¿åº¦æ ¡éªŒ
     - å”¯ä¸€æ€§æ ¡éªŒ
   - å‰ç«¯è¡¥å……è¾“å…¥æ¡†ï¼Œé€‚é…åç«¯

## è®¾è®¡

|     å­—æ®µ     | è¡¨ç¤ºå«ä¹‰ |      æ•°æ®ç±»å‹      |     é»˜è®¤/ä½æ•°     |
| :----------: | :------: | :----------------: | :---------------: |
|      id      | å”¯ä¸€æ ‡è¯† |       bigint       |     è‡ªå¢/ä¸»é”®     |
|   username   |   nick   |      varchar       |        256        |
| userAccount  | ç™»é™†è´¦å· |      varchar       |        256        |
|  avatarUrl   |   å¤´åƒ   |      varchar       |       1024        |
|    gender    |   æ€§åˆ«   |      tinyint       |                   |
| userPassword |   å¯†ç    |      varchar       |        512        |
|    phone     |   ç”µè¯   |      varchar       |        128        |
|    email     |   é‚®ç®±   |      varchar       |        512        |
|  userStatus  | ç”¨æˆ·çŠ¶æ€ |        int         |   é»˜è®¤å€¼0ã€éç©º   |
|  createTime  | åˆ›å»ºæ—¶é—´ | datetime/timestamp | current_timestamp |
|  updateTime  | æ›´æ–°æ—¶é—´ | datatime/timestamp | current_timestamp |
|   isDelete   | æ˜¯å¦åˆ é™¤ |      tinyint       |   é»˜è®¤å€¼0ã€éç©º   |
|   userRole   |   æƒé™   |      tinyint       |  ç®¡ç†å‘˜/æ™®é€šç”¨æˆ·  |

## æŠ€æœ¯é€‰å‹

å‰ç«¯ï¼šä¸‰ä»¶å¥— + React + ç»„ä»¶åº“ Ant Design + Umi + Ant Design Proï¼ˆç°æˆçš„ç®¡ç†ç³»ç»Ÿï¼‰

åç«¯ï¼š

- java
- springï¼ˆä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œå¸®åŠ©ä½ ç®¡ç† Java å¯¹è±¡ï¼Œé›†æˆä¸€äº›å…¶ä»–çš„å†…å®¹ï¼‰
- springmvcï¼ˆweb æ¡†æ¶ï¼Œæä¾›æ¥å£è®¿é—®ã€restfulæ¥å£ç­‰èƒ½åŠ›ï¼‰
- mybatisï¼ˆJava æ“ä½œæ•°æ®åº“çš„æ¡†æ¶ï¼ŒæŒä¹…å±‚æ¡†æ¶ï¼Œå¯¹ jdbc çš„å°è£…ï¼‰
- mybatis-plusï¼ˆå¯¹ mybatis çš„å¢å¼ºï¼Œä¸ç”¨å†™ sql ä¹Ÿèƒ½å®ç°å¢åˆ æ”¹æŸ¥ï¼‰
- springbootï¼ˆ **å¿«é€Ÿå¯åŠ¨** / å¿«é€Ÿé›†æˆé¡¹ç›®ã€‚ä¸ç”¨è‡ªå·±ç®¡ç† spring é…ç½®ï¼Œä¸ç”¨è‡ªå·±æ•´åˆå„ç§æ¡†æ¶ï¼‰
- junit å•å…ƒæµ‹è¯•åº“
- mysql æ•°æ®åº“

éƒ¨ç½²ï¼šæœåŠ¡å™¨ / å®¹å™¨ï¼ˆå¹³å°ï¼‰

## ç§åˆå§‹åŒ– Java é¡¹ç›®çš„æ–¹å¼

1. GitHub æœç°æˆçš„ä»£ç 
2. SpringBoot å®˜æ–¹çš„æ¨¡æ¿ç”Ÿæˆå™¨ï¼ˆ[https://start.spring.io/ï¼‰](https://start.spring.io/%EF%BC%89)
3. ç›´æ¥åœ¨ IDEA å¼€å‘å·¥å…·ä¸­ç”Ÿæˆ  âœ”

å¦‚æœè¦å¼•å…¥ java çš„åŒ…ï¼Œå¯ä»¥å» maven ä¸­å¿ƒä»“åº“å¯»æ‰¾ [Maven Repository: Central](https://mvnrepository.com/repos/central)

## è®¡åˆ’

1. åˆå§‹åŒ–é¡¹ç›®
   1. å‰ç«¯åˆå§‹åŒ–
      1. åˆå§‹åŒ–é¡¹ç›®ï¼ˆè¡¥å……npxï¼‰

         ```bash
         npm i @ant-design/pro-cli@3.1.0 -g
         npm pro create myapp
         yarn add @umijs/preset-ui -D
         ```

      2. å¼•å…¥ç»„ä»¶

      3. é¡¹ç›®ç˜¦èº«
   2. åç«¯åˆå§‹åŒ–
      1. ä¸»å¤‡ç¯å¢ƒï¼ˆMysqlï¼‰
      2. å¼•å…¥æ¡†æ¶



## è¡¥å……

### **ä¸€ã€å¯†ç ğŸ”åŠ å¯†å¸¸è§æ–¹å¼**

#### **1. ä¸ºä»€ä¹ˆé€‰æ‹© BCryptï¼Ÿ**

- **å®‰å…¨æ€§**ï¼šå†…ç½®éšæœºç›ï¼ˆSaltï¼‰ï¼Œé˜²æ­¢å½©è™¹è¡¨æ”»å‡»ã€‚
- **è‡ªé€‚åº”**ï¼šæ”¯æŒè°ƒæ•´è®¡ç®—å¤æ‚åº¦ï¼ˆå¯¹æŠ—ç¡¬ä»¶ç ´è§£ï¼‰ã€‚
- **æ ‡å‡†åŒ–**ï¼šSpring Security é»˜è®¤ä½¿ç”¨ã€‚

#### **2. ä½¿ç”¨ Spring Security çš„ BCryptPasswordEncoder**

```java
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;

public class PasswordUtils {
    private static final BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();

    // åŠ å¯†å¯†ç 
    public static String encrypt(String rawPassword) {
        return encoder.encode(rawPassword);
    }

    // æ ¡éªŒå¯†ç 
    public static boolean matches(String rawPassword, String encodedPassword) {
        return encoder.matches(rawPassword, encodedPassword);
    }
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
String rawPassword = "user123";
String encryptedPassword = PasswordUtils.encrypt(rawPassword); 
// è¾“å‡ºç±»ä¼¼ï¼š$2a$10$N9qo8uLOickgx2ZMRZoMy.MrE1L4BlCQ08J0L2uQk7n6O7WQyHu/.a

// æ ¡éªŒå¯†ç 
boolean isValid = PasswordUtils.matches("user123", encryptedPassword); // true
```

------

###  äºŒã€**å…¶ä»–å¯é€‰æ–¹æ¡ˆ**

#### **1. PBKDF2ï¼ˆé€‚åˆæ— Springç¯å¢ƒï¼‰**

```java
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.PKeySpec;
import java.security.spec.KeySpec;
import java.util.Base64;

public class PBKDF2Example {
    public static String encrypt(String password, String salt) throws Exception {
        KeySpec spec = new PKeySpec(password.toCharArray(), salt.getBytes(), 65536, 256);
        SecretKeyFactory factory = SecretKeyFactory.getInstance("PBKDF2WithHmacSHA256");
        byte[] hash = factory.generateSecret(spec).getEncoded();
        return Base64.getEncoder().encodeToString(hash);
    }
}
```

#### **2. Argon2ï¼ˆæ›´å®‰å…¨ï¼Œä½†éœ€ç¬¬ä¸‰æ–¹åº“ï¼‰**

```pom
<dependency>
    <groupId>de.mkammerer</groupId>
    <artifactId>argon2-jvm</artifactId>
    <version>2.11</version>
</dependency>
```

```java
import de.mkammerer.argon2.Argon2;
import de.mkammerer.argon2.Argon2Factory;

public class Argon2Example {
    public static String encrypt(String password) {
        Argon2 argon2 = Argon2Factory.create();
        return argon2.hash(10, 65536, 1, password.toCharArray());
    }
}
```

------

### ä¸‰ã€âš ï¸ **ç¦æ­¢ä½¿ç”¨çš„æ–¹æ¡ˆ**

- **MD5/SHA-1**ï¼šå·²è¢«ç ´è§£ï¼Œä¸å®‰å…¨ã€‚
- **è‡ªå®šä¹‰åŠ å¯†ç®—æ³•**ï¼šå®¹æ˜“å¼•å…¥æ¼æ´ã€‚
- **æ˜æ–‡å­˜å‚¨**ï¼šæåº¦å±é™©ã€‚

------

### å››ã€ğŸ“Œ **æœ€ä½³å®è·µ**

1. **å§‹ç»ˆåŠ ç›ï¼ˆSaltï¼‰**ï¼šBCrypt å·²å†…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†ã€‚

2. **å¤æ‚åº¦è°ƒæ•´**ï¼š

   java

   å¤åˆ¶

   ```
   // è°ƒæ•´BCryptå¼ºåº¦ï¼ˆé»˜è®¤10ï¼Œè¶Šå¤§è¶Šå®‰å…¨ä½†è¶Šæ…¢ï¼‰
   new BCryptPasswordEncoder(12);
   ```

3. **æ•°æ®åº“å­—æ®µé•¿åº¦**ï¼š

   - BCrypt å“ˆå¸Œå€¼å›ºå®š60ä½ï¼Œå»ºè®®è®¾ `VARCHAR(100)`ã€‚

4. **å‰ç«¯ä¼ è¾“**ï¼š

   - å¯†ç å¿…é¡»é€šè¿‡ HTTPS ä¼ è¾“ï¼Œå‰ç«¯å¯åšä¸€æ¬¡ SHA-256 å“ˆå¸Œï¼ˆä½†åç«¯ä»éœ€BCryptï¼‰ã€‚

------

### ğŸŒ° **å®Œæ•´Spring Bootæ•´åˆç¤ºä¾‹**

java

å¤åˆ¶

```
@Configuration
public class SecurityConfig {
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}

@Service
public class UserService {
    @Autowired
    private PasswordEncoder passwordEncoder;

    public void register(User user) {
        user.setPassword(passwordEncoder.encode(user.getRawPassword()));
        userRepository.save(user);
    }

    public boolean login(String username, String rawPassword) {
        User user = userRepository.findByUsername(username);
        return passwordEncoder.matches(rawPassword, user.getPassword());
    }
}
```

------

### **æ€»ç»“**

- **é¦–é€‰**ï¼š`BCryptPasswordEncoder`ï¼ˆSpring Securityæä¾›ï¼‰ã€‚
- **å¤‡é€‰**ï¼šPBKDF2ï¼ˆJDKå†…ç½®ï¼‰æˆ– Argon2ï¼ˆç¬¬ä¸‰æ–¹åº“ï¼‰ã€‚
- **å…³é”®åŸåˆ™**ï¼šæ°¸è¿œä¸è¦è‡ªå·±å®ç°åŠ å¯†ç®—æ³•ï¼


### **npx çš„æ ¸å¿ƒç”¨é€”**

1. **ä¸´æ—¶è¿è¡ŒåŒ…**
   å¦‚æœæŸä¸ªåŒ…ï¼ˆä¾‹å¦‚ `create-react-app`ï¼‰ä½ åªæ˜¯å¶å°”ä½¿ç”¨ä¸€æ¬¡ï¼Œä¸éœ€è¦å…¨å±€å®‰è£…ï¼Œå¯ä»¥ç›´æ¥ç”¨ `npx` è°ƒç”¨ã€‚

   ```
   npx create-react-app my-app
   ```

   - npx ä¼šä¸´æ—¶ä¸‹è½½è¯¥åŒ…ï¼Œæ‰§è¡Œå®Œå‘½ä»¤åè‡ªåŠ¨æ¸…ç†ï¼Œé¿å…å…¨å±€å®‰è£…çš„å†—ä½™ã€‚

2. **æ‰§è¡Œæœ¬åœ°å®‰è£…çš„åŒ…**
   å¦‚æœé¡¹ç›®ä¸­å®‰è£…äº†æŸä¸ªåŒ…ï¼ˆæ¯”å¦‚ `eslint`ï¼‰ï¼Œä½†æ²¡æœ‰å…¨å±€å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ `npx` ç›´æ¥è¿è¡Œï¼š

   ```
   npx eslint .
   ```

3. **è¿è¡Œä¸åŒç‰ˆæœ¬çš„åŒ…**
   å¯ä»¥æŒ‡å®šç‰¹å®šç‰ˆæœ¬è¿è¡Œï¼Œé¿å…å…¨å±€ç‰ˆæœ¬çš„å†²çªï¼š

   ```
   npx node@14 myscript.js
   ```

4. **ç›´æ¥è¿è¡Œè¿œç¨‹ä»“åº“çš„åŒ…**
   ç”šè‡³å¯ä»¥è¿è¡Œæœªå‘å¸ƒçš„åŒ…ï¼ˆå¦‚ GitHub ä»“åº“ä¸­çš„ä»£ç ï¼‰ï¼š

   ```
   npx github:username/repo
   ```

------

### **npx ä¸ npm çš„åŒºåˆ«**

| è¡Œä¸º             | `npm`                                      | `npx`                                      |
| ---------------- | ------------------------------------------ | ------------------------------------------ |
| å…¨å±€å®‰è£…åŒ…       | `npm install -g create-react-app`          | æ— éœ€å®‰è£…ï¼Œç›´æ¥è¿è¡Œï¼š`npx create-react-app` |
| è¿è¡Œæœ¬åœ°å®‰è£…çš„åŒ… | éœ€é€šè¿‡ `npm run` æˆ– `./node_modules/.bin/` | ç›´æ¥ `npx åŒ…å`                            |
| ç®¡ç†ä¾èµ–         | æ˜¯ï¼ˆå®‰è£…ã€æ›´æ–°ã€åˆ é™¤ï¼‰                     | å¦ï¼ˆä»…æ‰§è¡Œï¼‰                               |

------

### **å¸¸è§ä½¿ç”¨åœºæ™¯**

#### 1. åˆå§‹åŒ–é¡¹ç›®è„šæ‰‹æ¶ï¼ˆæœ€ç»å…¸ç”¨æ³•ï¼‰

```
npx create-react-app my-app      # åˆ›å»º React åº”ç”¨
npx @vue/cli create my-vue-app   # åˆ›å»º Vue åº”ç”¨
```

#### 2. è¿è¡Œæµ‹è¯•å·¥å…·

```
npx jest                         # æ‰§è¡Œ Jest æµ‹è¯•
npx mocha                        # æ‰§è¡Œ Mocha æµ‹è¯•
```

#### 3. æ‰§è¡Œä¸€æ¬¡æ€§è„šæœ¬

```
npx cowsay "Hello World!"        # è¿è¡Œä¸€ä¸ªè¶£å‘³å‘½ä»¤è¡Œå·¥å…·
```

#### 4. ä½¿ç”¨ç‰¹å®š Node.js ç‰ˆæœ¬

```
npx node@14 myscript.js          # ç”¨ Node.js 14 è¿è¡Œè„šæœ¬
```

------

### **æ³¨æ„äº‹é¡¹**

- å¦‚æœæœ¬åœ°å·²å®‰è£…æŸä¸ªåŒ…ï¼Œ`npx` ä¼šä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬ã€‚
- å¦‚æœæœ¬åœ°æœªå®‰è£…ï¼Œ`npx` ä¼šä» npm ä»“åº“ä¸‹è½½ä¸´æ—¶åŒ…ï¼Œæ‰§è¡Œååˆ é™¤ã€‚
- å¯ä»¥é€šè¿‡ `--no-install` å¼ºåˆ¶ä½¿ç”¨æœ¬åœ°åŒ…ï¼Œæˆ– `--ignore-existing` å¼ºåˆ¶é‡æ–°ä¸‹è½½ã€‚

------

### **æ€»ç»“**

- **æ ¸å¿ƒä»·å€¼**ï¼š`npx` è®©åŒ…çš„ä½¿ç”¨æ›´è½»é‡åŒ–ï¼Œé¿å…å…¨å±€å®‰è£…çš„æ±¡æŸ“ï¼Œæ–¹ä¾¿ç‰ˆæœ¬ç®¡ç†ã€‚
- **æ›¿ä»£æ–¹æ¡ˆ**ï¼šåœ¨ `npx` å‡ºç°å‰ï¼Œäººä»¬éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ `./node_modules/.bin/åŒ…å`ï¼Œæˆ–å…¨å±€å®‰è£…å·¥å…·ã€‚

## bugæ€»ç»“

### ä¸€ã€long å’Œ Long

Optional long parameter 'id' is present but cannot be translated into a null value due to being declared as a primitive type. Consider declaring it as object wrapper for the corresponding primitive type.

#### é—®é¢˜åŸå› 

- **åŸºæœ¬ç±»å‹ï¼ˆå¦‚ longï¼‰** ä¸èƒ½ä¸º `null`ï¼Œä½† HTTP è¯·æ±‚å¯èƒ½ä¸ä¼  `id` æˆ–ä¼ ç©ºå€¼ã€‚
- **Spring MVC æ— æ³•å°†ç¼ºå¤±çš„å‚æ•°** è½¬æ¢ä¸ºåŸºæœ¬ç±»å‹ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

#### é—®é¢˜è§£å†³

#### **æ–¹æ³• 1ï¼šæ”¹ç”¨åŒ…è£…ç±»å‹ Longï¼ˆæ¨èï¼‰**

```
@DeleteMapping("/delete")
public boolean deleteUser(@RequestParam(required = false) Long id) {  // ä½¿ç”¨ Long è€Œé long
    if (id == null || id <= 0) {  // æ˜¾å¼æ£€æŸ¥ null
        return false;
    }
    return userService.removeById(id);
}
```

**ä¼˜ç‚¹**ï¼š

- å…è®¸ `id` ä¸º `null`ï¼ˆå¦‚ `DELETE /delete`ï¼‰ã€‚
- æ›´ç¬¦åˆ RESTful è®¾è®¡ï¼ˆå¯é€‰å‚æ•°ï¼‰ã€‚

------

#### **æ–¹æ³• 2ï¼šå¼ºåˆ¶è¦æ±‚å‚æ•°ï¼ˆéç©ºï¼‰**

å¦‚æœ `id` å¿…é¡»ä¼ ï¼Œå¯ä»¥è¿™æ ·ï¼š

```
@DeleteMapping("/delete")
public boolean deleteUser(@RequestParam long id) {  // é»˜è®¤ required=true
    if (id <= 0) {
        return false;
    }
    return userService.removeById(id);
}
```

**è¡Œä¸º**ï¼š

- å¦‚æœè¯·æ±‚ä¸å¸¦ `id`ï¼ˆå¦‚ `DELETE /delete`ï¼‰ï¼ŒSpring ä¼šè¿”å› `400 Bad Request`ã€‚

------

#### **æ–¹æ³• 3ï¼šè®¾ç½®é»˜è®¤å€¼**

```
@DeleteMapping("/delete")
public boolean deleteUser(@RequestParam(defaultValue = "0") long id) {
    if (id <= 0) {
        return false;
    }
    return userService.removeById(id);
}
```

**è¡Œä¸º**ï¼š

- å¦‚æœè¯·æ±‚ä¸å¸¦ `id`ï¼Œé»˜è®¤å€¼ä¸º `0`ã€‚

### äºŒã€lombokä¸**ç”Ÿæ•ˆ**

**é—®é¢˜æè¿°**ï¼šåœ¨å®ä½“ç±»userä¸­ä½¿ç”¨lombok ä¸­çš„`@Data`æ³¨è§£ï¼Œä½†æ˜¯åç¼–è¯‘å‡ºæ¥çš„javaæ–‡ä»¶ä¸­å´æ²¡æœ‰å¯¹åº”çš„getå’Œsetæ–¹æ³•ï¼Ÿ

**é—®é¢˜è§£å†³**ï¼šï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

### ä¸‰ã€ç©ºæŒ‡é’ˆï¼Œå•å…ƒæµ‹è¯•

**é—®é¢˜æè¿°**ï¼šåœ¨è¿›è¡Œå•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œå‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸

**é—®é¢˜è§£å†³**ï¼šå› ä¸ºåœ¨æµ‹è¯•ç±»ä¸Šæ²¡æœ‰æ·»åŠ  `@SpringBootTest` æ³¨è§£

### å››ã€mybatis-plusé»˜è®¤å¼€å¯é©¼å³°å‘½åè½¬æ¢

**é—®é¢˜æè¿°**ï¼š

- MyBatis-Plus **é»˜è®¤å¼€å¯é©¼å³°å‘½åè½¬æ¢**ï¼Œä¼šå°† `userAccount` è½¬æ¢ä¸º `user_account`ã€‚
- å¦‚æœæ•°æ®åº“ä¸­åˆ—åæ˜¯ `useraccount`ï¼ˆæ— ä¸‹åˆ’çº¿ï¼‰ï¼Œä¼šå¯¼è‡´ SQL è¯­æ³•é”™è¯¯ã€‚

**é—®é¢˜è§£å†³**ï¼š

#### **æ–¹æ³• 1ï¼šåœ¨å®ä½“ç±»ä¸­ä½¿ç”¨ @TableField æŒ‡å®šæ•°æ®åº“åˆ—å**

ä¿®æ”¹ `User` ç±»ï¼Œæ˜¾å¼æŒ‡å®šå­—æ®µå¯¹åº”çš„æ•°æ®åº“åˆ—åï¼š

```java
@Data
@TableName("user")  // ç¡®ä¿è¡¨åæ­£ç¡®
public class User {
    @TableId(type = IdType.AUTO)
    private Long id;
    
    @TableField("username")  // å¦‚æœæ•°æ®åº“åˆ—åæ˜¯ username
    private String username;
    
    @TableField("useraccount")  // æ˜¾å¼æŒ‡å®šæ•°æ®åº“åˆ—åï¼ˆæ— ä¸‹åˆ’çº¿ï¼‰
    private String userAccount;
    
    // å…¶ä»–å­—æ®µåŒç†...
}
```

#### **æ–¹æ³• 2ï¼šå…¨å±€é…ç½® MyBatis-Plus çš„å­—æ®µå‘½åç­–ç•¥**

åœ¨ `application.yml`/`application.properties` ä¸­é…ç½®ï¼š

```java
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: false  # å…³é—­é©¼å³°è½¬ä¸‹åˆ’çº¿
```

æˆ–ï¼š

```java
mybatis-plus:
  global-config:
    db-config:
      column-format: "%s"  # ç¦ç”¨å­—æ®µåæ ¼å¼åŒ–ï¼ˆåŸæ ·ä½¿ç”¨ï¼‰
```

#### **æ–¹æ³• 3ï¼šä¿®æ”¹æ•°æ®åº“è¡¨ç»“æ„ï¼ˆä¸æ¨èï¼‰**

å¦‚æœå…è®¸ä¿®æ”¹æ•°æ®åº“ï¼Œå°†åˆ—åæ”¹ä¸ºå¸¦ä¸‹åˆ’çº¿çš„å½¢å¼ï¼š

```java
ALTER TABLE user CHANGE useraccount user_account VARCHAR(255);
```

### äº”ã€**Spring Boot Profile æœªæ¿€æ´»é—®é¢˜**

#### **1. é—®é¢˜æè¿°**

- **ç¯å¢ƒ**ï¼šSpring Boot åº”ç”¨éƒ¨ç½²åˆ°çº¿ä¸ŠæœåŠ¡å™¨ï¼ˆLinuxï¼‰

- **ç°è±¡**ï¼š

  - æœ¬åœ°å¼€å‘ç¯å¢ƒä½¿ç”¨ `--spring.profiles.active=prod` å¯ä»¥æ­£å¸¸æ¿€æ´» `prod` Profileã€‚
  - çº¿ä¸ŠæœåŠ¡å™¨ä½¿ç”¨ç›¸åŒå‘½ä»¤å¯åŠ¨ï¼Œä½†æ—¥å¿—æ˜¾ç¤º `No active profile set, falling back to default`ï¼Œå¯¼è‡´æ•°æ®åº“è¿æ¥å¤±è´¥ï¼ˆé”™è¯¯ä½¿ç”¨ `root` ç”¨æˆ·è€Œéé…ç½®çš„ `upjustin` ç”¨æˆ·ï¼‰ã€‚

- **å…³é”®é”™è¯¯æ—¥å¿—**ï¼š

  ```
  2025-04-15 22:26:13.559 INFO 21491 --- [main] c.j.u.UsercenterbdApplication: No active profile set, falling back to 1 default profile: "default"
  ```

------

#### **2. æ ¹æœ¬åŸå› **

1. **é…ç½®æ–‡ä»¶åç¼€åä¸åŒ¹é…**
   - çº¿ä¸ŠæœåŠ¡å™¨ä½¿ç”¨çš„é…ç½®æ–‡ä»¶åä¸º `application-prod.yaml`ï¼ˆ`.yaml` åç¼€ï¼‰ï¼Œä½† Spring Boot **é»˜è®¤ä»…åŠ è½½ .yml åç¼€çš„é…ç½®æ–‡ä»¶**ï¼Œå¯¼è‡´é…ç½®æœªè¢«è¯†åˆ«ã€‚
   - æœ¬åœ°å¼€å‘ç¯å¢ƒå¯èƒ½å›  IDE æˆ–ç¯å¢ƒå˜é‡å…¼å®¹äº† `.yaml`ï¼Œä½†çº¿ä¸Šç¯å¢ƒä¸¥æ ¼éµå¾ª Spring Boot é»˜è®¤è§„åˆ™ã€‚
2. **é…ç½®æ–‡ä»¶æœªæ­£ç¡®æ‰“åŒ…**
   - æ£€æŸ¥å‘ç° JAR åŒ…å†…ç¼ºå°‘ `application-prod.yml`ï¼Œå¯¼è‡´ `prod` Profile æ— æ³•æ¿€æ´»ã€‚

------

#### **3. è§£å†³æ–¹æ¡ˆ**

1. **ç»Ÿä¸€é…ç½®æ–‡ä»¶åç¼€å**

   - å°† `application-prod.yaml` é‡å‘½åä¸º `application-prod.yml`ï¼Œç¡®ä¿ Spring Boot èƒ½è‡ªåŠ¨åŠ è½½ã€‚

2. **é‡æ–°æ‰“åŒ…å¹¶éªŒè¯**

   - æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®ï¼Œç¡®ä¿ `application-prod.yml` è¢«æ‰“åŒ…åˆ° JAR ä¸­ï¼š

     ```bash
     mvn clean package  # Maven
     ./gradlew bootJar  # Gradle
     ```

   - éªŒè¯æ‰“åŒ…å†…å®¹ï¼š

     ```bash
     jar tf usercenterbd-0.0.1-SNAPSHOT.jar | grep application-prod.yml
     ```

3. **è°ƒæ•´å¯åŠ¨å‘½ä»¤**

   - ä½¿ç”¨æ ‡å‡†çš„ `--spring.profiles.active=prod`ï¼Œæ— éœ€é¢å¤–æŒ‡å®šæ–‡ä»¶è·¯å¾„ï¼š

     ```
     java -jar usercenterbd-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod
     ```

4. **éªŒè¯ Profile æ¿€æ´»**

   - å¯åŠ¨åæ£€æŸ¥æ—¥å¿—ï¼Œç¡®è®¤è¾“å‡ºï¼š

     ```log
     The following profiles are active: prod
     ```

------

#### **4. æ ¹æœ¬åŸå› åˆ†æ**

| **å› ç´ **       | **æœ¬åœ°ç¯å¢ƒ**                | **çº¿ä¸Šç¯å¢ƒ**                | **ç»“è®º**           |
| -------------- | --------------------------- | --------------------------- | ------------------ |
| é…ç½®æ–‡ä»¶åç¼€å | `.yaml` å¯èƒ½è¢« IDE å…¼å®¹     | Spring Boot é»˜è®¤åªè®¤ `.yml` | ç»Ÿä¸€æ”¹ç”¨ `.yml`    |
| é…ç½®æ–‡ä»¶æ‰“åŒ…   | å¯èƒ½å·²åŒ…å«                  | JAR åŒ…å†…ç¼ºå¤±                | æ£€æŸ¥æ‰“åŒ…ç»“æœ       |
| ç¯å¢ƒå˜é‡å¹²æ‰°   | æ—  `SPRING_PROFILES_ACTIVE` | å¯èƒ½æœ‰è¦†ç›–                  | æ£€æŸ¥å¹¶æ¸…ç†ç¯å¢ƒå˜é‡ |

------

#### **5. é¢„é˜²æªæ–½**

##### **1. è§„èŒƒé…ç½®æ–‡ä»¶å‘½å**

- **å¼ºåˆ¶ä½¿ç”¨ .yml åç¼€**ï¼Œé¿å… `.yaml` å¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ã€‚

- ç¤ºä¾‹ï¼š

  

  å¤åˆ¶

  ```
  application.yml          # é»˜è®¤é…ç½®
  application-prod.yml     # ç”Ÿäº§ç¯å¢ƒ
  application-dev.yml      # å¼€å‘ç¯å¢ƒ
  ```

##### **2. æ‰“åŒ…åéªŒè¯**

- éƒ¨ç½²å‰æ£€æŸ¥ JAR åŒ…å†…å®¹ï¼š

  ```
  jar tf your-app.jar | grep application-
  ```

##### **3. å¯åŠ¨æ—¶è°ƒè¯•**

- æ·»åŠ  `--debug` å‚æ•°ï¼Œç¡®è®¤ Profile å’Œé…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼š

  ```
  java -jar app.jar --spring.profiles.active=prod --debug
  ```

##### **4. æ–‡æ¡£è®°å½•**

- åœ¨é¡¹ç›®æ–‡æ¡£ä¸­æ˜ç¡®ï¼š
  - é…ç½®æ–‡ä»¶çš„å‘½åè§„åˆ™ã€‚
  - å¯åŠ¨å‘½ä»¤çš„æ ‡å‡†æ ¼å¼ã€‚

------

##### **5. æœ€ç»ˆæ•ˆæœ**

- **é—®é¢˜ä¿®å¤å**ï¼š
  çº¿ä¸ŠæœåŠ¡å™¨æˆåŠŸåŠ è½½ `prod` Profileï¼Œæ•°æ®åº“è¿æ¥ä½¿ç”¨æ­£ç¡®çš„ `upjustin` ç”¨æˆ·ï¼Œåº”ç”¨æ­£å¸¸è¿è¡Œã€‚



